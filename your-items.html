<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Your Items</title>
</head>
<body>
  <h1>Your Items Request</h1>
  <div id="friendInfo"></div>
  <div id="list"></div>
  <button id="confirmPrint">Print</button>

  <script>
  function load(){
    let payload=null;
    try { payload = JSON.parse(localStorage.getItem('itam_cart_submit') || 'null'); } catch(e) {}
    const list   = document.getElementById('list');
    const friend = document.getElementById('friendInfo');
    if (!payload || !payload.items || !payload.items.length) {
      list.innerHTML = '<div>No items in the request.</div>';
      friend.textContent = '';
    } else {
      friend.textContent = payload.friendEmail ? ('For friend: ' + payload.friendEmail) : '';
      list.innerHTML = payload.items.map(it => `
        <div>
          <div><strong>${it.name}</strong></div>
          <div>Quantity: ${it.qty}</div>
          <div>Ref: ${new Date(payload.ts).toLocaleString()}</div>
        </div>
      `).join('');
    }
    try { localStorage.removeItem('itam_cart_submit'); } catch(e) {}
    if (location.search) { history.replaceState(null, '', location.pathname); }
  }
  load();
  document.getElementById('confirmPrint').onclick=()=>window.print();
  </script>
</body>
</html>
